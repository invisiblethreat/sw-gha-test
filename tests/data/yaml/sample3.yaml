apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: slack-autoarchive
  namespace: kube-services 
  labels:
    alert_type: "37-5-devops"
spec:
  schedule: "0 12 * * *"
  successfulJobsHistoryLimit: 1 
  failedJobsHistoryLimit: 1
  concurrencyPolicy: "Forbid"
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            alert_type: "37-5-devops"
        spec:
          automountServiceAccountToken: false
          containers:
          - name: slack-autoachive
            imagePullPolicy: Always 
            image: pasientskyhosting/slack-autoarchive
            env:
            - name: "SLACK_TOKEN"
              value: "xoxp-177954516944-177954517072-656555308452-1d67367d82ef3c75a2e348a409f214bc"
            - name: "DAYS_INACTIVE"
              value: "60" 
          restartPolicy: OnFailure